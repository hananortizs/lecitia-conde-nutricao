---
alwaysApply: true
---

# Regras do Frontend - LetÃ­cia Conde NutriÃ§Ã£o

## ğŸ¯ **VisÃ£o Geral**

Single Page Application (SPA) para captaÃ§Ã£o de leads e agendamento de consultas nutricionais com integraÃ§Ã£o Google Login, sistema de anamnese multi-step e agendamento unificado (Site + WhatsApp).

## ğŸ—ï¸ **Arquitetura**

- **Framework**: React 19 com TypeScript
- **Build Tool**: Vite 7+
- **Styling**: Styled Components (CSS-in-JS)
- **Form Management**: React Hook Form
- **HTTP Client**: Axios
- **State Management**: React Hooks + Context API
- **Icons**: Lucide React
- **Date Handling**: date-fns

## ğŸ“ **Estrutura de Pastas**

```
frontend/
â”œâ”€â”€ public/                     # Arquivos estÃ¡ticos
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/            # Componentes reutilizÃ¡veis
â”‚   â”‚   â”œâ”€â”€ styled/           # Componentes estilizados base (Button, Input, Card)
â”‚   â”‚   â”œâ”€â”€ Layout/           # Layout e navegaÃ§Ã£o (Header, Footer, Layout)
â”‚   â”‚   â”œâ”€â”€ BmiCalculator.tsx # Calculadora de IMC
â”‚   â”‚   â”œâ”€â”€ AppointmentSteps.tsx # Sistema de anamnese multi-step
â”‚   â”‚   â”œâ”€â”€ AppointmentStart.tsx # Tela inicial de decisÃ£o (Site/WhatsApp)
â”‚   â”‚   â”œâ”€â”€ AppointmentScheduler.tsx # Agendamento tradicional
â”‚   â”‚   â”œâ”€â”€ GoogleLoginButton.tsx # BotÃ£o de login Google
â”‚   â”‚   â”œâ”€â”€ PreConsultationForm.tsx # FormulÃ¡rio de prÃ©-consulta (legado)
â”‚   â”‚   â””â”€â”€ steps/            # Steps da anamnese
â”‚   â”‚       â”œâ”€â”€ BasicInfoStep.tsx
â”‚   â”‚       â”œâ”€â”€ GoalsStep.tsx
â”‚   â”‚       â”œâ”€â”€ ExperienceStep.tsx
â”‚   â”‚       â””â”€â”€ AppointmentStep.tsx
â”‚   â”œâ”€â”€ pages/                # PÃ¡ginas da aplicaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ Home.tsx          # PÃ¡gina inicial
â”‚   â”‚   â”œâ”€â”€ AppointmentPage.tsx # PÃ¡gina de agendamento (legado)
â”‚   â”‚   â”œâ”€â”€ AboutPage.tsx     # PÃ¡gina sobre
â”‚   â”‚   â””â”€â”€ ContactPage.tsx   # PÃ¡gina de contato
â”‚   â”œâ”€â”€ contexts/             # Contextos React
â”‚   â”‚   â”œâ”€â”€ ThemeContext.tsx  # Contexto de tema (claro/escuro)
â”‚   â”‚   â””â”€â”€ AuthContext.tsx   # Contexto de autenticaÃ§Ã£o (Google Login)
â”‚   â”œâ”€â”€ services/             # ServiÃ§os e integraÃ§Ãµes
â”‚   â”‚   â””â”€â”€ api.ts            # Cliente HTTP e serviÃ§os da API
â”‚   â”œâ”€â”€ types/                # DefiniÃ§Ãµes TypeScript
â”‚   â”‚   â””â”€â”€ index.ts          # Interfaces e tipos
â”‚   â”œâ”€â”€ theme/                # Sistema de temas
â”‚   â”‚   â””â”€â”€ index.ts          # DefiniÃ§Ãµes de tema
â”‚   â”œâ”€â”€ utils/                # UtilitÃ¡rios e helpers
â”‚   â”œâ”€â”€ config/               # ConfiguraÃ§Ãµes
â”‚   â”‚   â””â”€â”€ google.ts         # ConfiguraÃ§Ã£o Google OAuth
â”‚   â””â”€â”€ App.tsx               # Componente principal
â”œâ”€â”€ package.json
â””â”€â”€ vite.config.ts
```

## ğŸŒ **IntegraÃ§Ã£o com API**

### **Base URL**

- **Development**: `http://localhost:5000` (padrÃ£o)
- **ConfiguraÃ§Ã£o**: VariÃ¡vel de ambiente `VITE_API_URL`
- **Base Path**: `/lcn` (nÃ£o `/api` ou `/pms`) - **IMPORTANTE**

### **Endpoints Utilizados**

**EspaÃ§os (âœ… Implementados) / Pendentes (ğŸ”´)**

#### **Leads**

- âœ… `POST /lcn/leads/capture-lead` - Capturar lead
- âœ… `GET /lcn/leads/{id}` - Obter lead por ID
- âœ… `GET /lcn/leads` - Listar todos os leads
- ğŸ”´ `GET /lcn/leads/find?email={email}&whatsapp={whatsapp}` - **PENDENTE: Verificar cliente recorrente**

#### **Appointments**

- Controller: `AppointmentController` â†’ `/lcn/appointment` (kebab-case automÃ¡tico)
- âœ… `GET /lcn/appointment/available-slots` - HorÃ¡rios disponÃ­veis
- âœ… `POST /lcn/appointment/reserve` - Reservar horÃ¡rio
- âœ… `GET /lcn/appointment/check-availability` - Verificar disponibilidade
- ğŸ”´ `POST /lcn/pre-consultation` - **PENDENTE: Salvar anamnese completa**
- ğŸ”´ `POST /lcn/appointment/reserve-whatsapp` - **PENDENTE: Reservar via WhatsApp**
- ğŸ”´ `PUT /lcn/appointment/{id}/reschedule` - **PENDENTE: Reagendar**

#### **Payment**

- âœ… `POST /lcn/payment/webhook` - Webhook de pagamento

### **Cliente HTTP (Axios)**

- Base URL configurÃ¡vel via `.env`
- Interceptadores para tratamento de erros
- Loading states para melhor UX
- Timeout de 10 segundos
- Retry automÃ¡tico em caso de falha (futuro)

### **âš ï¸ IMPORTANTE: Base Path Correto**

O arquivo `frontend/src/services/api.ts` usa base path `/lcn/`:

- âœ… **Correto**: `/lcn/leads/...`, `/lcn/appointment/...`, `/lcn/payment/...`
- âŒ **Incorreto**: `/api/...` ou `/pms/...`

## ğŸ¨ **Sistema de Temas**

### **Paleta de Cores - Tema Claro**

- **Primary**: #4CAF50 (Verde mÃ©dio - SaÃºde)
- **Secondary**: #2196F3 (Azul - ConfianÃ§a)
- **Accent/CTA**: #FF7043 (Laranja - Energia)
- **Background**: #FAFAFA
- **Surface**: #FFFFFF
- **Text**: #333333
- **Text Secondary**: #757575
- **Border**: #E0E0E0
- **Success Coldor**: #4CAF50
- **Error**: #F44336
- **Warning**: #FF9800

### **Paleta de Cores - Tema Escuro**

- **Primary**: #66BB6A (Verde claro)
- **Secondary**: #42A5F5 (Azul claro)
- **Accent/CTA**: #FF8A65 (Laranja claro)
- **Background**: #121212
- **Surface**: #1E1E1E
- **Text**: #FAFAFA
- **Text Secondary**: #B0B0B0
- **Border**: #424242
- **Success**: #66BB6A
- **Error**: #EF5350
- **Warning**: #FFA726

### **DetecÃ§Ã£o de Tema**

- Detectar preferÃªncia do sistema automaticamente
- Permitir alternÃ¢ncia manual
- Salvar preferÃªncia no localStorage
- Aplicar tema instantaneamente
- TransiÃ§Ãµes suaves entre temas

## ğŸ”§ **Funcionalidades Principais**

### **âœ… Calculadora de IMC**

- CÃ¡lculo instantÃ¢neo no frontend (peso / alturaÂ²)
- ValidaÃ§Ã£o em tempo real
- ClassificaÃ§Ã£o automÃ¡tica (OMS):
  - Abaixo do peso: < 18.5
  - Peso normal: 18.5 - 24.9
  - Sobrepeso: 25.0 - 29.9
  - Obesidade Grau I: 30.0 - 34.9
  - Obesidade Grau II: 35.0 - 39.9
  - Obesidade Grau III: â‰¥ 40.0
- Feedback visual imediato
- IntegraÃ§Ã£o com Google Login
- PrÃ©-preenchimento automÃ¡tico de dados
- PersistÃªncia de sessÃ£o (localStorage)
- Altura em centÃ­metros (50-300cm)

### **âœ… AutenticaÃ§Ã£o Google**

- OAuth 2.0 com Google Identity Services
- Captura de dados: `name`, `email`, `googleId`, `firstName`, `lastName`, `locale`, `emailVerified`
- PersistÃªncia de sessÃ£o via `AuthContext`
- PrÃ©-preenchimento automÃ¡tico de formulÃ¡rios
- Logout funcional com limpeza de dados

### **âœ… Sistema de Anamnese Multi-Step**

**Fluxo Completo:**

1. **Tela Inicial** (`AppointmentStart.tsx`)

   - DecisÃ£o: Agendar via Site ou WhatsApp
   - Badge "Indicado para novos clientes"
   - InformaÃ§Ã£o para clientes recorrentes

2. **Step 1: InformaÃ§Ãµes BÃ¡sicas** (`BasicInfoStep.tsx`)

   - Nome Completo \*
   - Email \*
   - WhatsApp \* (com mÃ¡scara)
   - Data de Nascimento \* (maior de 18 anos)
   - GÃªnero \*

3. **Step 2: Objetivos e MotivaÃ§Ã£o** (`GoalsStep.tsx`)

   - Objetivos principais (mÃºltipla escolha)
   - MotivaÃ§Ã£o pessoal (texto)

4. **Step 3: ExperiÃªncia e HÃ¡bitos** (`ExperienceStep.tsx`)

   - ExperiÃªncia anterior com nutriÃ§Ã£o
   - Dieta atual
   - FrequÃªncia de refeiÃ§Ãµes
   - RestriÃ§Ãµes alimentares

5. **Step 4: Agendamento** (`AppointmentStep.tsx`)
   - Tipo de consulta (Primeira Consulta: 30-90min)
   - CalendÃ¡rio interativo (date-fns)
   - SeleÃ§Ã£o de data
   - SeleÃ§Ã£o de horÃ¡rios disponÃ­veis (buscar do backend - **PENDENTE**)
   - Resumo da consulta

**Guia de Progresso:**

- CÃ­rculos numerados conectados por linha
- Estados: Ativo, Completo, Inativo
- NavegaÃ§Ã£o por setas (topo) e botÃµes (inferior)
- BotÃµes "Anterior/PrÃ³ximo" condicionais

### **ğŸ”´ CaptaÃ§Ã£o de Leads**

- âœ… FormulÃ¡rio de captura apÃ³s cÃ¡lculo do IMC
- âœ… ValidaÃ§Ã£o de dados
- âœ… Envio para API (`POST /lcn/leads/capture-lead`)
- âœ… Feedback de sucesso/erro
- ğŸ”´ Salvamento de anamnese completa (**PENDENTE**)

### **ğŸ”´ Sistema de Agendamento**

- âœ… VisualizaÃ§Ã£o de horÃ¡rios disponÃ­veis (hardcoded - **CORRIGIR**)
- âœ… SeleÃ§Ã£o de data e hora (calendÃ¡rio)
- ğŸ”´ ValidaÃ§Ã£o de disponibilidade em tempo real (**PENDENTE**)
- ğŸ”´ CriaÃ§Ã£o de appointment apÃ³s anamnese (**PENDENTE**)
- ğŸ”´ IntegraÃ§Ã£o com sistema de pagamento (**PENDENTE**)
- ğŸ”´ ConfirmaÃ§Ã£o de agendamento (**PENDENTE**)

### **ğŸ”´ Cliente Recorrente**

- ğŸ”´ VerificaÃ§Ã£o automÃ¡tica ao carregar componente (**PENDENTE**)
- ğŸ”´ Endpoint `GET /lcn/leads/find` (**PENDENTE no backend**)
- ğŸ”´ Fluxo diferenciado (WhatsApp recomendado) (**PENDENTE**)
- ğŸ”´ IdentificaÃ§Ã£o via email/WhatsApp (**PENDENTE**)

## ğŸ“± **Responsividade**

### **Breakpoints**

- **Mobile**: < 768px
- **Tablet**: 768px - 1024px
- **Desktop**: > 1024px

### **Design Mobile-First**

- ComeÃ§ar com design mobile
- Expandir para telas maiores
- Touch-friendly em dispositivos mÃ³veis
- Performance otimizada
- PrevenÃ§Ã£o de overflow horizontal
- Scroll horizontal quando necessÃ¡rio (guia de progresso)
- Cards empilhados verticalmente no mobile

### **Melhorias Mobile**

æœ‰äº›- Overflow horizontal evitado (width: 100%, max-width: 100%, box-sizing: border-box)

- Padding e fontes responsivos
- BotÃµes com tamanhos adequados
- Texto truncado com ellipsis quando necessÃ¡rio
- Layout vertical para cards
- NavegaÃ§Ã£o tÃ¡til otimizada

## ğŸ¯ **UX/UI Guidelines**

### **PrincÃ­pios de Design**

- Interface limpa e intuitiva
- Feedback visual claro
- AnimaÃ§Ãµes suaves e funcionais
- Acessibilidade (WCAG 2.1 AA)
- NavegaÃ§Ã£o consistente
- Estados de carregamento visÃ­veis
- Mensagens de erro amigÃ¡veis

### **Componentes**

- **BotÃµes**: Estados (normal, hover, active, disabled, loading)
- **Inputs**: ValidaÃ§Ã£o visual com mensagens de erro
- **Modais**: Para confirmaÃ§Ãµes importantes
- **Loading Spinners**: Durante requisiÃ§Ãµes
- **Toast Notifications**: Para feedback de aÃ§Ãµes (futuro)
- **Progress Indicators**: Para processos multi-step
- **Cards**: Com sombras e bordas arredondadas

### **PadrÃµes de NavegaÃ§Ã£o**

- **Guia de Progresso**: CÃ­rculos conectados com linha
- **NavegaÃ§Ã£o Entre Steps**: Setas no topo + botÃµes no rodapÃ©
- **Condicional**: BotÃµes sÃ³ aparecem quando aplicÃ¡vel
- **Feedback Visual**: Estados claros (ativo, completo, inativo)

## ğŸ“ **Naming Conventions**

### **Arquivos e Pastas**

- **Components**: PascalCase (e.g., `BmiCalculator.tsx`, `AppointmentSteps.tsx`)
- **Pages**: PascalCase (e.g., `Home.tsx`, `AppointmentPage.tsx`)
- **Hooks**: camelCase com prefixo "use" (e.g., `useAuth`, `useTheme`)
- **Utils**: camelCase (e.g., `bmiCalculator.ts`, `validators.ts`)
- **Types**: camelCase (e.g., `types.ts`)
- **Services**: camelCase (e.g., `api.ts`)

### **VariÃ¡veis e FunÃ§Ãµes**

- **Variables**: camelCase (e.g., `userName`, `isLoading`, `bmiResult`)
- **Functions**: camelCase (e.gí•¨ `calculateBmi`, `validateInput`, `handleSubmit`)
- **Constants**: UPPER_SNAKE_CASE (e.g., `API_BASE_URL`, `MAX_WEIGHT`)
- **Styled Components**: PascalCase (e.g., `StyledButton`, `Container`, `StepIndicator`)

### **React Components**

- **Component Names**: PascalCase (e.g., `BmiCalculator`, `AppointmentSteps`)
- **Props**: camelCase (e.g., `onSubmit`, `isVisible`, `userData`)
- **State Variables**: camelCase (e.g., `isLoading`, `formData`, `errorMessage`)
- **Transient Props**: Prefixo `$` para styled-components (e.g., `$variant`, `$loading`, `$error`)

### **Styled Components**

- Use transient props (`$prop`) para evitar warnings do React
- Props passadas para DOM devem ter prefixo `$`
- Exemplo: `$variant`, `$loading`, `$disabled`, `$isActive`, `$isCompleted`

## ğŸš€ **Performance**

### **OtimizaÃ§Ãµes**

- Lazy loading de componentes (futuro)
- Code splitting por rota (futuro)
- MemoizaÃ§Ã£o com `React.memo` quando necessÃ¡rio
- OtimizaÃ§Ã£o de re-renders
- CompressÃ£o de imagens
- Build otimizado com Vite

### **Bundle Size**

- Tree shaking automÃ¡tico (Vite)
- MinificaÃ§Ã£o de CSS e JS
- OtimizaÃ§Ã£o de assets
- AnÃ¡lise de bundle size (futuro)

## ğŸ”§ **Development Guidelines**

### **Code Quality**

- ESLint para linting
- TypeScript para type safety
- Prettier para formataÃ§Ã£o (futuro)
- Husky para pre-commit hooks (futuro)
- Testes unitÃ¡rios com Jest (futuro)
- Testes de integraÃ§Ã£o com React Testing Library (futuro)

### **State Management**

- Use React hooks para estado local (`useState`, `useEffect`)
- Context API para estado global (`ThemeContext`, `AuthContext`)
- Evite prop drilling
- Mantenha estado prÃ³ximo ao componente que o usa
- PersistÃªncia com `localStorage` quando apropriado

### **Error Handling**

- Error boundaries para capturar erros (futuro)
- Tratamento de erros de API no `api.ts`
- Fallbacks para componentes que falham (futuro)
- Logging de erros para debugging
- Mensagens de erro amigÃ¡veis ao usuÃ¡rio

### **Form Handling**

- Use React Hook Form para formulÃ¡rios
- ValidaÃ§Ã£o com `yup` ou `zod` (futuro)
- Feedback visual de erros
- PrevenÃ§Ã£o de submit duplo
- Reset de formulÃ¡rios apÃ³s sucesso

## ğŸ¯ **PendÃªncias CrÃ­ticas**

### **IntegraÃ§Ã£o Backend**

1. **âœ… URLs da API Corrigidas**

   - Arquivo: `frontend/src/services/api.ts`
   - âœ… Base path `/lcn/` implementado
   - âœ… Controller `AppointmentController` â†’ `/lcn/appointment` (singular)

2. **Implementar salvamento de anamnese**

   - Arquivo: `App.tsx` - `handleAppointmentComplete`
   - Criar endpoint no backend: `POST /lcn/pre-consultation`
   - Enviar dados da anamnese completa

3. **Integrar busca de horÃ¡rios do backend**

   - Arquivo: `AppointmentStep.tsx`
   - Usar `appointmentService.getAvailableSlots()`
   - Buscar slots por data selecionada

4. **Finalizar fluxo de agendamento**

   - Criar appointment apÃ³s anamnese
   - Integrar `appointmentService.reserveTimeSlot()`
   - Tratamento de erros

5. **Verificar cliente recorrente**
   - Arquivo: `AppointmentSteps.tsx` (linhas 471, 564)
   - Remover TODOs
   - Implementar busca via `GET /lcn/leads/find`
   - Ajustar fluxo conforme tipo de cliente

### **Funcionalidades Pendentes**

1. Sistema de pagamento (integraÃ§Ã£o)
2. GeraÃ§Ã£o de link Google Meet
3. PÃ¡ginas de feedback (sucesso/erro)
4. Loading states em todas requisiÃ§Ãµes
5. Toast notifications
6. Reagendamento de consultas
7. Dashboard admin (futuro)

## ğŸ“š **ReferÃªncias**

- Regras de NegÃ³cio: `backend/REGRAS_NEGOCIO.md`
- Arquitetura de Agendamento: `backend/AGENDAMENTO_UNIFICADO.md`
- AnÃ¡lise do Projeto: `ANALISE_PROJETO_PROXIMOS_PASSOS.md`
